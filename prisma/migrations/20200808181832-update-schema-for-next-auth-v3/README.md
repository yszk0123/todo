# Migration `20200808181832-update-schema-for-next-auth-v3`

This migration has been generated by Yuji Suzuki at 8/8/2020, 6:18:32 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."Account.providerAccountId"

ALTER TABLE "public"."Account" ADD COLUMN "compoundId" text   ,
ADD COLUMN "updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP;

ALTER TABLE "public"."User" ADD COLUMN "emailVerified" timestamp(3)   ,
ADD COLUMN "image" text   ;

CREATE  INDEX "Account.providerAccountId" ON "public"."Account"("providerAccountId")

CREATE  INDEX "Account.providerId" ON "public"."Account"("providerId")

CREATE  INDEX "Account.userId" ON "public"."Account"("userId")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200726204845-add-color-pink..20200808181832-update-schema-for-next-auth-v3
--- datamodel.dml
+++ datamodel.dml
@@ -2,39 +2,48 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
 }
 model User {
-  id          String       @default(uuid()) @id
-  email       String       @unique
-  avatarUrl   String?
-  name        String?
-  accounts    Account[]
-  categories  Category[]
-  todos       Todo[]
-  tags        Tag[]
-  createdAt   DateTime     @default(now())
-  checkpoints Checkpoint[]
+  id            String       @default(uuid()) @id
+  email         String       @unique
+  emailVerified DateTime?
+  avatarUrl     String?
+  image         String?
+  name          String?
+  accounts      Account[]
+  categories    Category[]
+  todos         Todo[]
+  tags          Tag[]
+  createdAt     DateTime     @default(now())
+  checkpoints   Checkpoint[]
 }
 model Account {
   id                 String    @default(uuid()) @id
+  compoundId         String?
   userId             String
   user               User      @relation(fields: [userId], references: [id])
   providerId         String
   providerType       String
-  providerAccountId  String    @unique
+  providerAccountId  String
   refreshToken       String?
   accessToken        String
   accessTokenExpires DateTime?
   createdAt          DateTime  @default(now())
+  updatedAt          DateTime  @default(now())
+
+
+  @@index([providerAccountId])
+  @@index([providerId])
+  @@index([userId])
 }
 model Category {
   id         String    @default(uuid()) @id
```


