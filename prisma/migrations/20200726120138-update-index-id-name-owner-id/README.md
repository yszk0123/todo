# Migration `20200726120138-update-index-id-name-owner-id`

This migration has been generated by Yuji Suzuki at 7/26/2020, 12:01:38 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."Category.id_name_ownerId"

DROP INDEX "public"."Checkpoint.id_ownerId"

DROP INDEX "public"."Tag.id_ownerId"

DROP INDEX "public"."Todo.id_ownerId"

CREATE  INDEX "Category.id_name" ON "public"."Category"("id","name")

CREATE  INDEX "Category.ownerId" ON "public"."Category"("ownerId")

CREATE  INDEX "Checkpoint.id" ON "public"."Checkpoint"("id")

CREATE  INDEX "Checkpoint.ownerId" ON "public"."Checkpoint"("ownerId")

CREATE  INDEX "Tag.id" ON "public"."Tag"("id")

CREATE  INDEX "Tag.ownerId" ON "public"."Tag"("ownerId")

CREATE  INDEX "Todo.id" ON "public"."Todo"("id")

CREATE  INDEX "Todo.ownerId" ON "public"."Todo"("ownerId")

ALTER TABLE "public"."Tag" ADD FOREIGN KEY ("parentId")REFERENCES "public"."Tag"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200726111633-add-tag-tree..20200726120138-update-index-id-name-owner-id
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -45,9 +45,10 @@
   ownerId    String
   todos      Todo[]
   tags       Tag[]
-  @@index([id, name, ownerId])
+  @@index([id, name])
+  @@index([ownerId])
 }
 model Todo {
   id           String      @default(uuid()) @id
@@ -62,9 +63,10 @@
   tags         Tag[]
   status       TodoStatus  @default(TODO)
   archivedAt   DateTime?
-  @@index([id, ownerId])
+  @@index([id])
+  @@index([ownerId])
 }
 model Tag {
   id         String     @default(uuid()) @id
@@ -79,9 +81,10 @@
   parentId   String?
   parent     Tag?       @relation("TagTree", fields: [parentId], references: [id])
   children   Tag[]      @relation("TagTree")
-  @@index([id, ownerId])
+  @@index([id])
+  @@index([ownerId])
 }
 model Checkpoint {
   id         String    @default(uuid()) @id
@@ -91,9 +94,10 @@
   ownerId    String
   todos      Todo[]
   archivedAt DateTime?
-  @@index([id, ownerId])
+  @@index([id])
+  @@index([ownerId])
 }
 enum TodoStatus {
   TODO
```


